<!DOCTYPE html>
<html>
    <head>
        <title>Page accueil client - PROACT'IF</title>
        <meta charset="UTF-8">
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <style>
            button{border-radius: 10px; color : white; background-color: green}.center{text-align: center;}
            div.haut{background-color: blue; margin : 20px; padding : 20 px;}
            h1{color: white; text-align: center;}
            p{text-align: center;}
            input{border-radius: 10px;}
            a{color: white; float: right; width:auto;}
            table{border: 2px solid black; width: 100%;}
            th{border: 2px solid black;}
            td{border: 2px solid black;}
        </style>
    </head>
    <body>
        <div class="haut">
            <a href="index.html">Déconnexion</a>
            <h1 id="message-client"></h1>
            <button id="intervention-client">Demander une nouvelle intervention</button><br/>
        </div>
        <p><b>Historique des dernières interventions</b></p>
        <p>Cliquez sur une ligne pour afficher les détails de l'intervention</p>
        <table id="table-intervention">
            <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Description</th>
                <th>Statut</th>
            </tr>
        </table>
        <script>

            function chargerPageAccueilClient() {
                
                $.ajax({
                    url: './ActionServlet',
                    method: 'POST',
                    data: {
                        todo: 'chargerPageAccueilClient'
                    },
                    dataType: 'json'
                }).done(function (data) {
                    
                    $('#message-client').html('Bonjour '+data.prenomClient);
                    $.each(data.interventionsClient, function(i,intervention) {
                        $('#table-intervention').append('<tr><td>'+intervention.dateDebut+'</td><td>'+intervention.type+'</td><td>'+intervention.description+'</td><td>'+intervention.description+'</td></tr>');
                    });
                    
                   
                });
            }

            function demandeIntervention() {
                window.location = "pageDemandeInterventionClient.html";
            }
            
           

            $(document).ready(function () {
                
                chargerPageAccueilClient();
                $('#intervention-client').on('click', function () {
                    
                    demandeIntervention();
                });
                
               
                
            });
            
        </script>
    </body>
</html>
