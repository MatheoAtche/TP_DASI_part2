<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Demande intervention - PROACT'IF</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
         <style>
            body{background-color: blue;}
            h1{color: white; text-align: center;}
            p{color: white;}
            a{color: white;}
            div{float: left; width: 20%;}
            img{width: 100px; height: 100px;}
            #champs-livraison{visibility: hidden; }
            #champs-incident{visibility: hidden;}
            #champs-animal{visibility: hidden;}
            #message-client{visibility: hidden;}
            #valider{visibility: hidden;}
            button{float:right;width:50%;background-color: blue;color:white;border:blue;}
        </style>
    </head>
    <body>
        <a href="pageAccueilClient.html"> <-- </a>
        <button id="deconnexion">Déconnexion</button>
        <h1> Demande d'intervention </h1>
        
        <div>
            <button id="livraison">
                <img src="images/camion.jpg"/><br/>
                Livraison
            </button>
        </div>
        
        <div>
            <button id="incident">
                <img src="images/incident.jpg"/><br/>
                Incident
            </button>
        </div>
        
        <div>
            <button id="animal">
                <img src="images/chat.jpg"/><br/>
                Animal
            </button>
        </div>
        
        <div id="champs-livraison">
            <p> Pour quel objet ? </p>
            <input type="text" id="champ-livraison-objet"/><br>
            <p> Pour quelle entreprise ? </p>
            <input type="text" id="champ-livraison-livreur" /><br>
            <p> Décrivez votre problème </p>
            <input type="text" id="champ-livraison-description" /><br>
            <button id="validerLivraison">Valider</button>
        </div>
        
        <div id="champs-incident">
            <p> Décrivez votre problème </p>
            <input type="text" id="champ-incident-description" /><br>
            <button id="validerIncident">Valider</button>
        </div>
        
        <div id="champs-animal">
            <p> De quel animal s'agit-il ? </p>
            <input type="text" id="champ-animal-type" /><br>
            <p> Description de l'intervention </p>
            <input type="text" id="champ-animal-description"/><br>
            <button id="validerAnimal">Valider</button>
        </div>
        <p id="message-client">
            Nous n avons aucun employé disponible pour répondre
            à votre demande. Veuillez réessayer plus tard. Merci pour votre compréhension.
        </p>
        <script>

            function traiterLivraison() {
                
                document.getElementById("champs-livraison").style.visibility = "visible";
                document.getElementById("champs-incident").style.visibility = "hidden";
                document.getElementById("champs-animal").style.visibility = "hidden";
                document.getElementById("message-client").style.visibility = "hidden";
                
                var champObjet = $('#champ-livraison-objet').val();
                var champEntreprise = $('#champ-livraison-livreur').val();
                var champDescription = $('#champ-livraison-description').val();
                
                $('#validerLivraison').on('click', function () {
                    $.ajax({
                        url: './ActionServlet',
                        method: 'POST',
                        data: {
                            todo: 'ajouterIntervention',
                            type: 'livraison',
                            objet: champObjet,
                            entreprise: champEntreprise,
                            description: champDescription
                        },
                        dataType: 'json'
                    }).done(function (data) {

                        if(data.resultatAjoutIntervention=="KO") {
                            document.getElementById("message-client").style.visibility = "visible";
                        } else {
                            window.location = "pageAccueilClient.html";
                            //MESSAGE CLIENT
                        }

                    });
                });
               
            }
            
            function traiterIncident() {
                
                document.getElementById("champs-incident").style.visibility = "visible";
                document.getElementById("champs-livraison").style.visibility = "hidden";
                document.getElementById("champs-animal").style.visibility = "hidden";
                document.getElementById("message-client").style.visibility = "hidden";
                
                var champDescription = $('#champ-incident-description').val();
                
                 $('#validerIncident').on('click', function () {
                    alert('c');
                    $.ajax({
                        url: './ActionServlet',
                        method: 'POST',
                        data: {
                            todo: 'ajouterIntervention',
                            type: 'incident',
                            description: champDescription
                        },
                        dataType: 'json'
                    }).done(function (data) {

                        if(data.resultatAjoutIntervention=="KO") {
                            document.getElementById("message-client").style.visibility = "visible";
                        } else {
                            window.location = "pageAccueilClient.html";
                        }

                    });
                    
                });
               
            }
            
            function traiterAnimal() {
                
                document.getElementById("champs-animal").style.visibility = "visible";
                document.getElementById("champs-incident").style.visibility = "hidden";
                document.getElementById("champs-livraison").style.visibility = "hidden";
                document.getElementById("message-client").style.visibility = "hidden";
                
                var champAnimal = $('#champ-animal-type').val();
                var champDescription = $('#champ-animal-description').val();
                
                 $('#validerAnimal').on('click', function () {
                    
                    $.ajax({
                        url: './ActionServlet',
                        method: 'POST',
                        data: {
                            todo: 'ajouterIntervention',
                            type: 'animal',
                            description: champDescription,
                            animal: champAnimal
                        },
                        dataType: 'json'
                    }).done(function (data) {

                        if(data.resultatAjoutIntervention=="KO") {
                            document.getElementById("message-client").style.visibility = "visible";
                        } else {
                            window.location = "pageAccueilClient.html";
                        }

                    });
                    
                    
                });
            }
            
            function deconnexion() {
                
                    $.ajax({
                        url: './ActionServlet',
                        method: 'POST',
                        data: {
                            todo: 'deconnexionClient'
                        }
                    }).done(function () {
                        window.location = "index.html";
                    });
                
            }
            
            $(document).ready(function () {
                
                $('#livraison').on('click', function () {
                    traiterLivraison();
                });
                
                $('#incident').on('click', function () {
                    traiterIncident();
                });
                
                $('#animal').on('click', function () {
                    traiterAnimal();
                });
                
                $('#deconnexion').on('click', function () {
                    deconnexion();
                });
                 
            });
            
        </script>

    </body>
</html>
